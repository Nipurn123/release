var j=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,o)=>(typeof require<"u"?require:e)[o]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var I="code-line",f=class{constructor(e,o,n){this.element=e;this.line=o;this.codeElement=n;this._detailParentElements=Array.from(X(e,"DETAILS"))}get isVisible(){return!this._detailParentElements.some(e=>!e.open)}},S=(()=>{let t,e=-1;return o=>{if(!t||o!==e){e=o,t=[new f(document.body,-1)];for(let n of document.getElementsByClassName(I)){if(!(n instanceof HTMLElement))continue;let r=+n.getAttribute("data-line");isNaN(r)||(n.tagName==="CODE"&&n.parentElement&&n.parentElement.tagName==="PRE"?t.push(new f(n.parentElement,r,n)):n.tagName==="UL"||n.tagName==="OL"||t.push(new f(n,r)))}}return t}})();function M(t,e){let o=Math.floor(t),n=S(e),r=n[0]||null;for(let s of n){if(s.line===o)return{previous:s,next:void 0};if(s.line>o)return{previous:r,next:s};r=s}return{previous:r}}function J(t,e){let o=S(e).filter(a=>a.isVisible),n=t-window.scrollY,r=-1,s=o.length-1;for(;r+1<s;){let a=Math.floor((r+s)/2),d=p(o[a]);d.top+d.height>=n?s=a:r=a}let l=o[s],i=p(l);return s>=1&&i.top>n?{previous:o[r],next:l}:s>1&&s<o.length&&i.top+i.height>n?{previous:l,next:o[s+1]}:{previous:l}}function p({element:t}){let e=t.getBoundingClientRect(),o=t.querySelector(`.${I}`);if(o){let n=o.getBoundingClientRect(),r=Math.max(1,n.top-e.top);return{top:e.top,height:r}}return e}function b(t,e,o){if(!o.settings?.scrollPreviewWithEditor)return;if(t<=0){window.scroll(window.scrollX,0);return}let{previous:n,next:r}=M(t,e);if(!n)return;let s=0,l=p(n),i=l.top;if(r&&r.line!==n.line){let a=(t-n.line)/(r.line-n.line),d=i+l.height,y=r.element.getBoundingClientRect().top-d;s=d+a*y}else{let a=t-Math.floor(t);s=i+l.height*a}s=Math.abs(s)<1?Math.sign(s):s,window.scroll(window.scrollX,Math.max(1,window.scrollY+s))}function x(t,e){let{previous:o,next:n}=J(t,e);if(o){if(o.line<0)return 0;let r=p(o),s=t-window.scrollY-r.top;if(n){let l=s/(p(n).top-r.top);return o.line+l*(n.line-o.line)}else{let l=s/r.height;return o.line+l}}return null}function B(t,e){return S(e).find(o=>o.element.id===t)}function*X(t,e){for(let o=t.parentElement;o;o=o.parentElement)o.tagName===e&&(yield o)}var L=class{onDidChangeTextEditorSelection(e,o){let{previous:n}=M(e,o);this._update(n&&(n.codeElement||n.element))}_update(e){this._unmarkActiveElement(this._current),this._markActiveElement(e),this._current=e}_unmarkActiveElement(e){e&&e.classList.toggle("code-active-line",!1)}_markActiveElement(e){e&&e.classList.toggle("code-active-line",!0)}};function R(t){document.readyState==="loading"||document.readyState==="uninitialized"?document.addEventListener("DOMContentLoaded",t):t()}var W=(t,e)=>({postMessage(o,n){t.postMessage({type:o,source:e.settings.source,...n})}});function A(t){let e=document.getElementById("vscode-markdown-preview-data");if(e){let o=e.getAttribute(t);if(o)return o}throw new Error(`Could not load data for ${t}`)}function C(t){return JSON.parse(A(t))}var T=class{constructor(){this._settings=C("data-settings")}get settings(){return this._settings}updateSettings(e){this._settings=e}};import $ from"morphdom";var N=Object.freeze({http:"http",https:"https",file:"file",untitled:"untitled",mailto:"mailto",vscode:"vscode","vscode-insiders":"vscode-insiders",notebookCell:"vscode-notebook-cell"});function P(t,e){return e.toLowerCase().startsWith(t+":")}var O=j("lodash.throttle"),g=0,_=new L,c=new T,m=0,h=c.settings.source,w=acquireVsCodeApi(),k=w.getState()??{},u={...k,...C("data-state")};typeof k.scrollProgress<"u"&&k?.resource!==u.resource&&(u.scrollProgress=0);w.setState(u);var E=W(w,c);window.cspAlerter.setPoster(E);window.styleLoadingMonitor.setPoster(E);function D(t){let e=document.getElementsByTagName("img");if(e.length>0){let o=Array.from(e,n=>n.complete?Promise.resolve():new Promise(r=>{n.addEventListener("load",()=>r()),n.addEventListener("error",()=>r())}));Promise.all(o).then(()=>setTimeout(t,0))}else setTimeout(t,0)}R(()=>{let o=[...new DOMParser().parseFromString(A("data-initial-md-content"),"text/html").body.children];document.body.append(...o);for(let r of o)r instanceof HTMLElement&&H(r);let n=u.scrollProgress;if(q(),typeof n=="number"&&!c.settings.fragment){D(()=>{g+=1;let r=Math.max(1,n*document.body.clientHeight);window.scrollTo(0,r)});return}c.settings.scrollPreviewWithEditor&&D(()=>{if(c.settings.fragment){let r;try{r=encodeURIComponent(c.settings.fragment)}catch{r=c.settings.fragment}u.fragment=void 0,w.setState(u);let s=B(r,m);s&&(g+=1,b(s.line,m,c))}else isNaN(c.settings.line)||(g+=1,b(c.settings.line,m,c))}),typeof c.settings.selectedLine=="number"&&_.onDidChangeTextEditorSelection(c.settings.selectedLine,m)});var G=(()=>{let t=O(e=>{g+=1,D(()=>b(e,m,c))},50);return e=>{isNaN(e)||(u.line=e,t(e))}})();window.addEventListener("resize",()=>{g+=1,Y()},!0);function q(){let t=document.getElementsByTagName("img"),e=0;for(let o of t){o.id="image-"+e,e+=1;let n=o.getAttribute("data-src"),s=n&&!(P(N.http,n)||P(N.https,n))?"localImage":"image";o.setAttribute("data-vscode-context",JSON.stringify({webviewSection:s,id:o.id,preventDefaultContextMenuItems:!0,resource:h,imageSource:n}))}}async function V(t,e=5){if(!document.hasFocus()&&e>0){setTimeout(()=>{V(t,e-1)},20);return}try{await navigator.clipboard.write([new ClipboardItem({"image/png":new Promise(o=>{let n=document.createElement("canvas");n!==null&&(n.width=t.naturalWidth,n.height=t.naturalHeight,n.getContext("2d")?.drawImage(t,0,0)),n.toBlob(r=>{r&&o(r),n.remove()},"image/png")})})])}catch(o){console.error(o);let n=window.getSelection();if(!n){await navigator.clipboard.writeText(t.getAttribute("data-src")??t.src);return}n.removeAllRanges();let r=document.createRange();r.selectNode(t),n.addRange(r),document.execCommand("copy"),n.removeAllRanges()}}window.addEventListener("message",async t=>{let e=t.data;switch(e.type){case"copyImage":{let o=document.getElementById(e.id);o instanceof HTMLImageElement&&V(o);return}case"onDidChangeTextEditorSelection":e.source===h&&_.onDidChangeTextEditorSelection(e.line,m);return;case"updateView":e.source===h&&G(e.line);return;case"updateContent":{let o=document.querySelector(".markdown-body"),r=new DOMParser().parseFromString(e.content,"text/html");for(let s of Array.from(r.querySelectorAll("meta")))s.hasAttribute("http-equiv")&&s.remove();if(e.source!==h){h=e.source;let s=r.querySelector(".markdown-body");o.replaceWith(s),H(s)}else{let s=r.querySelector(".markdown-body"),l=s.querySelectorAll("link");for(let i of l)i.remove();s.prepend(...l),$(o,s,{childrenOnly:!0,onBeforeElUpdated:(i,a)=>{if(z(i,a)){let d=i.querySelectorAll("[data-line]"),y=a.querySelectorAll("[data-line]");d.length!==y.length&&console.log("unexpected line number change");for(let v=0;v<d.length;++v){let U=d[v],F=y[v];F&&U.setAttribute("data-line",F.getAttribute("data-line"))}return!1}return i.tagName==="DETAILS"&&a.tagName==="DETAILS"&&i.hasAttribute("open")&&a.setAttribute("open",""),!0},addChild:(i,a)=>{i.appendChild(a),a instanceof HTMLElement&&H(a)}})}++m,window.dispatchEvent(new CustomEvent("vscode.markdown.updateContent")),q();break}}},!1);document.addEventListener("dblclick",t=>{if(!c.settings.doubleClickToSwitchToEditor)return;for(let n=t.target;n;n=n.parentNode)if(n.tagName==="A")return;let e=t.pageY,o=x(e,m);typeof o=="number"&&!isNaN(o)&&E.postMessage("didClick",{line:Math.floor(o)})});var K=["http:","https:","mailto:","vscode:","vscode-insiders:"];document.addEventListener("click",t=>{if(!t)return;let e=t.target;for(;e;){if(e.tagName&&e.tagName==="A"&&e.href){if(e.getAttribute("href").startsWith("#"))return;let o=e.getAttribute("data-href");if(!o&&(o=e.getAttribute("href"),K.some(n=>o.startsWith(n))))return;if(!/^[a-z\-]+:/i.test(o)){E.postMessage("openLink",{href:o}),t.preventDefault(),t.stopPropagation();return}return}e=e.parentNode}},!0);window.addEventListener("scroll",O(()=>{if(Y(),g>0)g-=1;else{let t=x(window.scrollY,m);typeof t=="number"&&!isNaN(t)&&E.postMessage("revealLine",{line:t})}},50));function Y(){u.scrollProgress=window.scrollY/document.body.clientHeight,w.setState(u)}function z(t,e){let o=["open"];if(t.isEqualNode(e))return!0;if(t.tagName!==e.tagName||t.textContent!==e.textContent)return!1;let n=[...t.attributes].filter(i=>!o.includes(i.name)),r=[...e.attributes].filter(i=>!o.includes(i.name));if(n.length!==r.length)return!1;for(let i=0;i<n.length;++i){let a=n[i],d=r[i];if(a.name!==d.name||a.value!==d.value&&a.name!=="data-line")return!1}let s=Array.from(t.children),l=Array.from(e.children);return s.length===l.length&&s.every((i,a)=>z(i,l[a]))}function H(t){let e=["type","src","nonce","noModule","async"],o=t.tagName==="SCRIPT"?[t]:Array.from(t.getElementsByTagName("script"));for(let n of o){if(!(n instanceof HTMLElement))continue;let r=document.createElement("script"),s=n.innerText;r.text=s;for(let l of e){let i=n.getAttribute&&n.getAttribute(l);i&&r.setAttribute(l,i)}n.insertAdjacentElement("afterend",r),n.remove()}}
